!function(t,e){t.self!==t.top?t._CMLS={}:t._CMLS=t._CMLS||{},t._CMLS.LOADED||(t._CMLS.const=t._CMLS.const||{},t._CMLS.const.PLAYER_TUNEGENIE=8471,t._CMLS.const.PLAYER_TRITON=8468,t._CMLS.const.PLAYER_POSITION_TOP=80847980,t._CMLS.const.PLAYER_POSITION_BOTTOM=80667984,t._CMLS.logger=function cmlsLogger(e,o){if(!t._CMLS||!t._CMLS.debug||"object"!=typeof console||!console.groupCollapsed)return!1;t._CMLS.loggerNamesToColors=t._CMLS.loggerNamesToColors||{};var n,i,r=e,a=[].slice.call(o);t._CMLS.loggerNamesToColors[r]?(n=t._CMLS.loggerNamesToColors[r].background,i=t._CMLS.loggerNamesToColors[r].complement):(n=("000000"+Math.floor(16777215*Math.random()).toString(16)).slice(-6),i=parseInt(n,16)>=12303291?"000000":"FFFFFF",t._CMLS.loggerNamesToColors[r]={background:n,complement:i});var l=new Date;l=l.toISOString()?l.toISOString():l.toUTCString();var s=["%c["+r+"]","background: #"+n+"; color: #"+i];a=s.concat(a),t.top.console.groupCollapsed.apply(t.top.console,a),t.top.console.log("TIMESTAMP:",l),t.top.console.trace(),t.top.console.groupEnd()},t._CMLS.now=Date.now||function(){return(new Date).getTime()},t._CMLS.throttle=function(e,o,n){var i,r,a,l=null,s=0;n||(n={});var later=function(){s=!1===n.leading?0:t._CMLS.now(),l=null,a=e.apply(i,r),l||(i=r=null)};return function(){var d=t._CMLS.now();s||!1!==n.leading||(s=d);var c=o-(d-s);return i=this,r=arguments,c<=0||c>o?(l&&(clearTimeout(l),l=null),s=d,a=e.apply(i,r),l||(i=r=null)):l||!1===n.trailing||(l=setTimeout(later,c)),a}},t._CMLS.debounce=function(e,o,n){var i,r,a,l,s,later=function(){var d=t._CMLS.now()-l;d<o&&d>=0?i=setTimeout(later,o-d):(i=null,n||(s=e.apply(a,r),i||(a=r=null)))},debounced=function(){a=this,r=arguments,l=t._CMLS.now();var d=n&&!i;return i||(i=setTimeout(later,o)),d&&(s=e.apply(a,r),a=r=null),s};return debounced.clear=function(){clearTimeout(i),i=a=r=null},debounced},t._CMLS.whichPlayer=function(){if(t._CMLS.whichPlayerCache)return t._CMLS.whichPlayerCache;var e={type:null,position:null};return t.tgmp?(t._CMLS.logger("COMMON",["Found TuneGenie player."]),e.type=t._CMLS.const.PLAYER_TUNEGENIE,t.tgmp.options.position&&"top"!==t.tgmp.options.position.toLowerCase()?(t._CMLS.logger("COMMON",["TuneGenie player is on the bottom."]),e.position=t._CMLS.const.PLAYER_POSITION_BOTTOM):t.tgmp.options.position&&"top"===t.tgmp.options.position.toLowerCase()&&(t._CMLS.logger("COMMON",["TuneGenie player is on the top."]),e.position=t._CMLS.const.PLAYER_POSITION_TOP)):t.TDPW&&(t._CMLS.logger("COMMON",["Found Triton player, assuming it's on top."]),e.type=t._CMLS.const.PLAYER_TRITON,e.position=t._CMLS.const.PLAYER_POSITION_TOP),t._CMLS.whichPlayerCache=e,t._CMLS.whichPlayerCache},t._CMLS.isHomepage=function(e){return e||(e=t),"/"===e.location.pathname&&!1===/[\?&]?p=/i.test(e.location.search)},t._CMLS.triggerEvent=function(e,o,n){var i;t.document.createEvent?(i=t.document.createEvent("CustomEvent")).initCustomEvent(o,!0,!0,n):i=new CustomEvent(o,{detail:n}),e.dispatchEvent(i)},t._CMLS.logger("COMMON",["LIBRARY LOADED!\n                           .__                \n  ____  __ __  _____  __ __|  |  __ __  ______\n_/ ___\\|  |  \\/     \\|  |  \\  | |  |  \\/  ___/\n\\  \\___|  |  /  Y Y  \\  |  /  |_|  |  /___ \\ \n \\___  >____/|__|_|  /____/|____/____//____  >\n     \\/            \\/                      \\/ \n"]),t._CMLS.LOADED=!0)}(window),function(t,e,o){function log(){t.top._CMLS&&t.top._CMLS.hasOwnProperty("logger")&&t.top._CMLS.logger(n+" v0.1.1",arguments)}function loopDetection(){a=setTimeout(t._CMLS[i].detectTag,50),l++}var n="ADTAG DETECTION",i="adTagDetection",r="0.1.1";t._CMLS=t._CMLS||{},t._CMLS[i]=t._CMLS[i]||{},t._CMLS[i].registeredDetectors=t._CMLS[i].registeredDetectors||[];var StubInterface=function(){var t="STUB INTERFACE",e="InterfaceSTUB",o="adTagDetection",n="x",i=this;return this.identity="STUB",this.detectTag=function(){},this.rawInterface=function(){},this.queue=function(t){i.rawInterface().cmd.push(t)},this.pubads=function(){return i.rawInterface().pubads()},this.refresh=function(t){return log("Refresh called"),i.pubads().refresh(t)},this.addListener=function(t,e){},this.removeListener=function(t,e){},this.setTargeting=function(t,e){},this.defineSlot=function(t,e,o,n){},this.display=function(t){i.queue((function(){i.rawInterface().display(t)}))},this},a,l;t._CMLS[i].stubInterface=StubInterface,t._CMLS.adTag=new t._CMLS[i].stubInterface,t._CMLS[i].detectTag=function detectTag(){if(t._CMLS[i].registeredDetectors&&(log("Running registered detectors.",t._CMLS[i].registeredDetectors),t._CMLS[i].registeredDetectors.forEach((function(e){if(!e.identity)return log("Invalid interface in detector: "+e.identity),!1;log("Checking registered detector: "+e.identity),e.detectTag&&e.detectTag()&&(log("Interface found in detector: "+e.identity),t._CMLS.adTag=e)}))),!t._CMLS.adTag||!t._CMLS.adTag.rawInterface())return log("No interface found, rerunning detection."),void loopDetection()}}(window.self,jQuery),function(t,e,o){function log(){t.top._CMLS&&t.top._CMLS.hasOwnProperty("logger")&&t.top._CMLS.logger(n+" v0.1.2",arguments)}var n="DFP INTERFACE",i="adTagDetection",r="0.1.2";t._CMLS=t._CMLS||{},t._CMLS[i]=t._CMLS[i]||{},t._CMLS[i].registeredDetectors=t._CMLS[i].registeredDetectors||[];var a=new t._CMLS[i].stubInterface;a.identity="dfp",a.detectTag=function(){if(t.googletag)return log("Googletag detected."),!0},a.rawInterface=function(){return t.googletag},a.addListener=function(t,e){a.queue((function(){a.pubads().addEventListener(t,e)}))},a.removeListener=function(t,e){return a.pubads().removeEventListener(t,e)},a.setTargeting=function(t,e){return a.pubads().setTargeting(t,e)},a.defineSlot=function(t,e,o,n){var i=a.rawInterface().defineSlot.apply(null,t);if(!i)return!1;if(e&&(i=i.setCollapseEmptyDiv(!0)),Array.isArray(o))o.forEach((function(t){for(var e in t)t.hasOwnProperty(e)&&(i=i.setTargeting(e,t[e]))}));else if("object"==typeof o)for(var r in o)o.hasOwnProperty(r)&&(i=i.setTargeting(r,o[r]));return n&&(i=i.addService(a.pubads())),i},t._CMLS[i].registeredDetectors.push(a)}(window.self,jQuery),window._CMLS.adTagDetection.detectTag(),function(t,e,o){function log(){e.top._CMLS&&e.top._CMLS.logger&&e.top._CMLS.logger(n+" v0.6",arguments)}var n="Pushdown Ad",i="0.6",r="6717",a="dfp-pushdown2",l=15,s=e.document;if(!s.querySelector("body.home"))return log("Not on homepage, exiting."),!1;if(s.getElementById(a))return log("Tag already exists, exiting."),!1;if(!e.hasOwnProperty("googletag"))return log('DFP library must be included and "googletag" window variable must be available before including this library.'),!1;var d=e.googletag,c=e._CMLS&&e._CMLS.debounce?e._CMLS.debounce:function(t){t()},t=t.noConflict(),$=function(o,n){return new t.fn.init(o,n||e.document)};$.fn=$.prototype=t.fn,t.extend($,t),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(t)}((function(t){function b(){o&&(e.requestAnimationFrame(b),t.fx.tick())}var o;Number(t.fn.jquery.split(".")[0])>=3?e.console&&e.console.warn&&e.console.warn("The jquery.requestanimationframe plugin is not needed in jQuery 3.0 or newer as they handle it natively."):e.requestAnimationFrame&&(t.fx.timer=function(e){e()&&t.timers.push(e)&&!o&&(o=!0,b())},t.fx.stop=function(){o=!1})})),d.cmd.push((function(){function detectCreative(t){if(!t.length)return log("Could not find DFP iframe within ad container."),!1;try{t.contents()}catch(t){return log("Could not retrieve ad container contents, is this a safe frame?"),!1}return t.contents().find("#vpContainer").length?"vast":t.contents().find(".img_ad").length?"image":!!t.contents().find("video").length&&"video"}function handleImage(t){log("Handling Image creative type.");var e=t.contents().find(".img_ad");if(!e.length)return log("Attempted to handle an image creative, but no image was found."),!1;log("Making image responsive."),e.css({width:"100%",height:"auto"}),log("Checking for timeout override");var n=e.prop("alt").match(/timeout=(\d+)/i),r=n&&n.length>1?1e3*n[1]:15e3;return log("Triggering ad display with timeout",r),o.trigger("cmls.display",(function(){i.trigger("cmls.start",[r,function(){log("Triggering ad removal."),o.trigger("cmls.hide")}])})),!0}function handleVideo(t){log("Handling custom html video creative type.");var e=t.contents().find("video"),n=e.find("source");if(!e.length)return log("Attempted to handle a custom video creative, but no video tag was found."),!1;if(!e[0].canPlayType)return log("Current browser does not support HTML video."),!1;var r=!1;return n.each((function(){var t=$(this).prop("type");return!t||!e[0].canPlayType(t).replace(/no/,"")||(r=$(this),!1)})),!1===r?(log("No video source was found to be compatible with this browser."),!1):(log("Video has a compatible source."),e.prop("controls",!1).prop("muted",!0).prop("playsinline",!0).prop("autoplay",!1).on("mouseover",(function(){e.prop("muted",!1)})).on("mouseout",(function(){e.prop("muted",!0)})).on("canplaythrough",(function(){o.trigger("cmls.display",(function(){e[0].play()}))})).on("playing",(function(){i.trigger("cmls.start",1e3*this.duration)})).on("ended",(function(){o.trigger("cmls.hide")})),log("Video initialized."),!0)}function handleVast(t){log("Handling VAST-delivered creative.");var n={init:function(){log("Initializing VAST player.");var o=t.contents()[0],i=o.defaultView,r=o.getElementById("vpContainer");if(!r)return log("Attempted to handle VAST creative but no vpContainer was found."),!1;var a=r.getAttribute("data-vpurl");if(!a||a.length<1)return log("No vpurl attribute provided!"),!1;a=a.replace("[timestamp]",(new Date).getTime()).replace("[referrer_url]",e.location.href),i.player=new i.VASTPlayer(r),i.player.once("AdStopped",(function(){n.stopped()})),i.player.load(r.getAttribute("data-vpurl")).then((function startAd(){n.ready()})).catch((function(t){n.error(t)}))},ready:function(){var e,n=t.contents()[0].defaultView;n.player.adVolume=0,o.on("mouseover",(function(){n.player.adVolume=1})),o.on("mouseout",(function(){n.player.adVolume=0})),o.trigger("cmls.display",(function(){n.player.startAd().then((function(){log("VAST player playing."),i.trigger("cmls.start",1e3*n.player.adDuration)}))}))},stopped:function(){log("VAST player stopped."),o.trigger("cmls.hide")},error:function(t){log("Error from VAST player",t),o.trigger("cmls.hide")}};e._CMLS.vpPushdown=n;var r=t.contents()[0].createElement("script");r.onload=n.init,r.src="https://cdn.jsdelivr.net/npm/vast-player@latest/dist/vast-player.min.js",t.contents()[0].body.appendChild(r)}function checkRenderEvent(t){if(t.slot.getSlotElementId()===a){if(log("Caught relevant DFP render event.",t.slot.getSlotElementId()),t.isEmpty)return log("Slot was empty!"),o.trigger("cmls.hide"),!1;log("Handling ad.");var e=o.find("iframe:first");if(!e.length)return log("Attempted to handle ad, but no DFP iframe was found."),!1;var n=detectCreative(e);if(!n)return log("No supported ad creative type found."),!1;log("Ad type detected.",n),_[n](e)}}var t,o,n,i,r,l,g,p;if(!(p=$(".wrapper-content:first")).length)return log('Could not find ".wrapper-content" element.'),!1;try{var u,f=d.pubads().getSlots();if(f.length&&(f.some((function(e){var o=e.getAdUnitPath();if(o.indexOf("/6717/")>-1)return t=o,!0})),null==t))throw{message:"Could not retrieve ad unit path."}}catch(t){return log("Failed to retrieve DFP properties.",t),!1}log('Ad path found, defining new slot with "/pushdown" level.',t+="/pushdown");var h=s.createElement("div");h.id=a+"-container",h.style.display="none",o=$(h);var m=s.createElement("div");m.id=a,n=$(m).appendTo(o);var v=s.createElement("style");v.innerText=" \t\t\t\t#"+a+"-container { \t\t\t\t\tfont-size: 24px !important; \t\t\t\t\tfont-size: 5vw !important; \t\t\t\t\tfont-weight: lightest !important; \t\t\t\t\tline-height: 0 !important; \t\t\t\t\tmargin: 0 auto !important; \t\t\t\t\tmax-width: 1020px !important; \t\t\t\t\toverflow: hidden !important; \t\t\t\t\tposition: relative !important; \t\t\t\t\tz-index: 1 !important; \t\t\t\t} \t\t\t\t#"+a+" { \t\t\t\t\tposition: relative; \t\t\t\t\tmargin-bottom: 10px; \t\t\t\t} \t\t\t\t#"+a+' div[id*="google_ads"] { \t\t\t\t\tposition: relative; \t\t\t\t\tpadding-bottom: 56.25%; \t\t\t\t\tmax-width: 100%; \t\t\t\t\theight: 0; \t\t\t\t\toverflow: hidden; \t\t\t\t} \t\t\t\t#'+a+" iframe { \t\t\t\t\twidth: 100%; \t\t\t\t\theight: 100%; \t\t\t\t\tposition: absolute; \t\t\t\t\ttop: 0; \t\t\t\t\tleft: 0; \t\t\t\t} \t\t\t\t#"+a+"-close { \t\t\t\t\tcolor: white; \t\t\t\t\tfont-family: sans !important; \t\t\t\t\ttext-shadow: .05em .05em .25em black; \t\t\t\t\tmix-blend-mode: exclusion; \t\t\t\t\tcursor: pointer; \t\t\t\t\tposition: absolute; \t\t\t\t\ttop: .75em; \t\t\t\t\tright: .3em; \t\t\t\t\tz-index: 100000; \t\t\t\t} \t\t\t\t#"+a+"-timer { \t\t\t\t\tbackground: #a33; \t\t\t\t\twidth: 0; \t\t\t\t\theight: 3px; \t\t\t\t\tposition: absolute; \t\t\t\t\tbottom: 7px; \t\t\t\t\tleft: 0; \t\t\t\t\tz-index: 100000; \t\t\t\t} \t\t\t\t@media (min-width: 550px) { \t\t\t\t\t#"+a+"-container { font-size: 24px !important; } \t\t\t\t} \t\t\t\t",l=$(v).appendTo(o),g=$('<script> \t\t\t\tgoogletag.cmd.push(function() { \t\t\t\t\tgoogletag.display("'+a+'"); \t\t\t\t}); \t\t\t<\/script>').appendTo(n);var y=s.createElement("div");y.id=a+"-close",y.title="Close",y.innerText="âœ•",r=$(y).click((function(){o.trigger("cmls.hide")})).appendTo(o);var S=s.createElement("div");S.id=a+"-timer",i=$(S).appendTo(o),o.on("cmls.display",(function(t,e){log("Displaying ad"),o.stop().clearQueue().slideDown("fast"),e&&e()})),o.on("cmls.hide",(function(t,e){log("Hiding ad."),i.trigger("cmls.reset"),o.stop().clearQueue().slideUp(),e&&e()})),i.on("cmls.start",(function(t,e,o){log("Timer display started with duration",e),i.trigger("cmls.reset",(function(){log("Animating timerDiv"),i.animate({width:"100%"},e,"linear",o)}))})),i.on("cmls.reset",(function(t,e){log("Resetting timerDiv to 0"),i.stop().clearQueue().css("width",0),e&&(log("Callback from cmls.reset firing."),e())}));var _={image:handleImage,video:handleVideo,vast:handleVast};d.pubads().addEventListener("slotRenderEnded",(function(t){c(checkRenderEvent(t),500)})),log("Injecting ad tag."),d.defineSlot(t,[1020,574],a).setCollapseEmptyDiv(!0).setTargeting("pos","pushdown").addService(d.pubads()),p.prepend(o)}))}(jQuery,window.self),function(t,e){function log(){t._CMLS.logger(o+" v0.5",arguments)}var o="PLAYER WATCH",n="playerWatch",i="0.5";!t._CMLS[n]&&(t.TDPW?(t._CMLS[n]={initialized:!1,cache:{},timer:null,interval:2500,const:{STOPPED:0,PLAYING:1},setDFPCriteria:function setDFPCriteria(e,o){t.googletag=t.googletag||{},t.googletag.cmd=t.googletag.cmd||[],t.googletag.cmd.push((function(){log("Setting targeting",e,o),t.googletag.pubads().setTargeting(e,o)}))},checkCurrentTrack:function getCurrentTrack(){var e=!(!localStorage||!JSON)&&JSON.parse(localStorage.getItem("tdas.controller."+t.amp_player_config.station+"."+t.amp_player_config.stream_id+".events.current-state"));e&&e.data&&(e.data.stream&&"LIVE_PLAYING"===e.data.stream.code.toUpperCase()?this.setState(this.const.PLAYING):this.setState(this.const.STOPPED),e.data.song&&e.data.song.id&&this.hasTrackChanged(e.data.song.id)&&this.trackHasChanged(e.data.song))},setState:function setState(e){return e===this.const.PLAYING&&e!==this.cache.state?(log("Player is streaming."),this.cache.state=e,this.setDFPCriteria("td-player-state","PLAYING"),void t._CMLS.triggerEvent(t,"td-player.playing")):e===this.const.STOPPED&&e!==this.cache.state?(log("Player is stopped."),this.cache.state=e,this.setDFPCriteria("td-player-state","STOPPED"),void t._CMLS.triggerEvent(t,"td-player.stopped")):void 0},hasTrackChanged:function hasTrackChanged(t){return!(!t||t===this.cache.trackId)},trackHasChanged:function trackHasChanged(e){log("Song has changed!",e),this.cache.trackId=e.id,e.artist&&this.setDFPCriteria("td-player-artist",e.artist),e.album&&this.setDFPCriteria("td-player-album",e.album),e.title&&this.setDFPCriteria("td-player-track",e.title),this.setDFPCriteria("td-player-id",e.id),t._CMLS.triggerEvent(t,"td-player.trackchange",e)},startTimer:function startTimer(){var t=this;clearTimeout(this.timer),this.timer=null,this.timer=setTimeout((function(){t.checkCurrentTrack(),t.startTimer()}),this.interval)},init:function init(){return t.amp_player_config&&t.amp_player_config.station&&t.amp_player_config.stream_id?(this.checkCurrentTrack(),this.startTimer(),this.initialized=!0,log("Initialized!",this.cache.trackId),this):(log("Player configuration not available, exiting."),!1)}},t._CMLS[n].init()):log("Triton player not enabled, exiting."))}(window),function(t,e){function log(){t.top._CMLS&&t.top._CMLS.hasOwnProperty("logger")&&t.top._CMLS.logger(o+" v0.6.1",arguments)}var o="AUTO REFRESH ADS",n="autoRefreshAds",i="0.6.1";if(t.location.search.indexOf("cmlsDisableAdRefresh")>-1)log("Disabling due to cmlsDisableAdRefresh query.");else{if(t.DISABLE_AUTO_REFRESH_ADS)return log("Auto Refresh Ads is disabled locally with window.DISABLE_AUTO_REFRESH_ADS"),!1;t._CMLS.autoRefreshAdsTimer=t._CMLS.autoRefreshAdsTimer||4;var AutoRefresher=function(e){function getWindow(){if(a.type===t._CMLS.const.PLAYER_TUNEGENIE){var e=t.top.document.querySelector('iframe#page_frame,iframe[name="pwm_pageFrame"]');if(e&&e.contentWindow)return log("Window context is TuneGenie frame"),e.contentWindow}return log("Window context is window"),t}function checkConditions(){return t.top._CMLS.autoReload&&t.top._CMLS.autoReload.active?(log("AutoReloadPage is active, autoRefreshAds will be disabled."),-1):"visible"!==n?(log("Tab is hidden, autoRefreshAds will skip this cycle."),0):1}function checkTimer(){var t=checkConditions();if(1===t){var e=new Date;if(log("Checking timer",[e.toLocaleString(),s.toLocaleString()]),e.getTime()>=s.getTime())return void fire()}-1!==t?l=setTimeout((function(){checkTimer()}),1e4):o.stop()}function isElVisible(e){if(!e)return!1;var o=!1;e.style&&e.style.display&&"none"===e.style.display&&e.setAttribute("style","display: block; width: 1px; height: 1px;");var n=e.getBoundingClientRect();if(n.width=n.right-n.left,n.height=n.bottom-n.top,0===n.width||0===n.height)return!1;var i=n.top+n.height/2,r=n.right-n.width/2,a=n.bottom-n.height/2,l=n.left+n.width/2;return a>=0&&r>=0&&i<=(t.innerHeight||document.documentElement.clientHeight)&&l<=(t.innerWidth||document.documentElement.clientWidth)}function recordTabVisibility(e){e||(e=t.document[i]?"hidden":"visible"),n=e}function fire(){if(1===checkConditions()){var t=getWindow();return log("Firing!",t._CMLS.adTag),void t._CMLS.adTag.queue((function(){log("Refreshing viewable page ads."),o.resetFireTime();try{var e=t._CMLS.adTag.pubads().getSlots(),n=[];e.forEach((function(e){var o=t.document.getElementById(e.getSlotElementId());o&&isElVisible(o)&&n.push(e)}));var i=[];n.forEach((function(t){i.push("El: "+t.getSlotElementId(),"SlotId: "+t.getSlotId(),"Path: "+t.getAdUnitPath(),t.getSizes(),t)})),log("Viewable ads:",i),t._CMLS.adTag.refresh(n)}catch(t){log("Failed to refresh ads!",t)}o.start()}))}log("Conditions were not met before firing, skipping this cycle."),o.start()}var o=this,n="visible",i,r,a=t._CMLS.whichPlayer(),l=null,s=e||null,d=!1;void 0!==t.document.hidden?(i="hidden",r="visibilitychange"):void 0!==t.document.mozHidden?(i="mozHidden",r="mozvisibilitychange"):void 0!==t.document.msHidden?(i="msHidden",r="msvisibilitychange"):void 0!==t.document.webkitHidden?(i="webkitHidden",r="webkitvisibilitychange"):void 0!==t.document.oHidden&&(i="oHidden",r="ovisibilitychange"),t.document.addEventListener(r,(function(){recordTabVisibility()}),!1),this.checkState=function(){return d},this.stop=function(){log("Stopping timer."),clearTimeout(l),l=null,s=null,d=!1},this.start=function(t){return o.stop(),1===checkConditions()&&(t&&t instanceof Date?(log("Start called with an init fire time.",t),s=t):o.resetFireTime(),log("Starting timer, will fire at "+s.toLocaleString()),checkTimer(),d=!0),o},this.destroy=function(){o.stop()},this.getFireTime=function(){return s},this.resetFireTime=function(){s=new Date((new Date).getTime()+6e4*t._CMLS.autoRefreshAdsTimer)},s&&s instanceof Date&&(log("Instantiated with a time to fire, using it!"),o.start(s))};try{t.parent._CMLS[n].destroy()}catch(t){}try{t._CMLS[n].destroy()}catch(t){}t._CMLS[n]=new AutoRefresher,t._CMLS[n].start()}}(window.self),function(t,e,o){function log(){e._CMLS.logger(n+" v0.1",arguments)}function checkForPlayer(){log("Checking for player...",l),e._CMLS[i].isPlayerActive()?e._CMLS[i].init():l>20||(setTimeout(checkForPlayer,1e3),l++)}var n="NAV THROUGH PLAYER",i="navThroughPlayer",r="0.1",a=e._CMLS.whichPlayer();if(!e._CMLS[i]){e._CMLS[i]={isPlayerActive:function isPlayerActive(){return!!(a=e._CMLS.whichPlayer()).type},updateIframeLinks:function updateIframeLinks(o){if(e._CMLS[i].isPlayerActive)if(o){var n=o.jquery?o:t(o);if(o.getAttribute("src")&&(o.getAttribute("src").indexOf(e.location.hostname)<0||o.getAttribute("src").indexOf("/safeframe/")>0))log("Ad iframe is in a safeframe, cannot update.",o);else try{n.contents().find('a[target="_self"],a[target="_top"],a[target="_parent"]').each((function(){log("Updating links in slot.",n.prop("id"),n[0]),e._CMLS[i].updateLink(this)}))}catch(t){log("Could not update links in given iframe",o,t)}}else log("Did not receive an iframe node, cannot update",o)},updateLink:function updateLink(o,n){if(e._CMLS[i].isPlayerActive&&o){var r=o.jquery?o:t(o),a=e.document.createElement("a");if(a.href=r.prop("href"),-1!==a.href.indexOf("doubleclick.net")&&-1!==a.href.indexOf("adurl=/")){var l;if(log("Found a DFP clickthrough with a relative adurl!",a.href),"URLSearchParams"in e){var s=new e.URL(a.href),d;l=new e.URLSearchParams(s.search).get("adurl")}else for(var c=a.search.split("&"),g=0,p=c.length;g<p;g++){var u=c[g];if(u.indexOf("adurl=")>-1){var f=u.split("=");if(f.length>1){l=f[1];break}}}l?(a.href=a.href.replace("adurl=/","adurl="+e.location.protocol+"//"+e.location.hostname+"/"),r.prop("href",a.href),log("Modified relative DFP clickthrough",l,a.href)):log("Could not parse query string in DFP clickthrough",l)}else if(0===a.href.indexOf("/")||a.hostname!==e.location.hostname&&!n)return log("Relative or off-site URL found, will not modify"),void(a=null);r.off("."+i).on("click."+i,e._CMLS[i].clickThrough),a=null}},clickThrough:function clickThrough(t){t&&e._CMLS[i].isPlayerActive()&&(t.preventDefault(),log("Intercepting click."),e._CMLS[i].navigate(t.currentTarget.href))},navigate:function navigate(t){try{e.sharedContainerDataLayer&&e.sharedContainerDataLayer.push({event:"relative-ad-click",relativeAdURL:t}),e.corpDataLayer&&e.corpDataLayer.push({event:"relative-ad-click",relativeAdURL:t})}catch(t){console.log(t)}a.type===e._CMLS.const.PLAYER_TRITON&&e.History&&(log("Navigating through Triton player.",t),e.History.pushState(null,null,t)),a.type===e._CMLS.const.PLAYER_TUNEGENIE&&e.tgmp&&(log("Navigating through TuneGenie player.",t),e.tgmp.updateLocation(t))},init:function init(){e._CMLS[i].isPlayerActive()?(log("Initializing."),e.googletag=e.googletag||{},e.googletag.cmd=e.googletag.cmd||[],e.googletag.cmd.push((function(){e.googletag.pubads().addEventListener("slotRenderEnded",(function(t){if(t&&t.slot){var o=t.slot.getSlotElementId(),n=e.document.getElementById(o);e._CMLS[i].updateIframeLinks(n)}}))})),t('iframe[id^="google_ads_iframe"],#cmlsWallpaperInjectorContainer iframe').each((function(){e._CMLS[i].updateIframeLinks(this)})),t(e).load((function(){t('iframe[id^="google_ads_iframe"],#cmlsWallpaperInjectorContainer iframe').each((function(){e._CMLS[i].updateIframeLinks(this)}))})),log("Initialized.")):log("No player is active, exiting.")}};var l=0;checkForPlayer()}}(jQuery,window),function(t,e,o){function log(){e._CMLS.logger(i+" v0.5",arguments)}function WallpaperInjector(o){function determineTransitionEvent(){var t,e=document.createElement("fakeelement"),o={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkittransitionend",msTransition:"mstransitionend"};for(t in o)if(void 0!==e.style[t])return o[t]}function checksum(t){var e=0,o=t.length,n,i;if(0===o)return e;for(n=0;n<o;n++)e=(e<<5)-e+(i=t.charCodeAt(n)),e&=e;return e}function refreshCache(){return n.dfpSlot=t(o.dfpSlotNode),n.injectionNode=t(o.injectionNode),n.stickNode=t(o.stickNode),n.contentNode=t(o.contentNode),n.footerNode=t(o.footerNode),n.obstructiveNode=t(o.obstructiveNode),n.window=t(e),n.document=t(e.document),refreshStickAtPosition(),n}function refreshStickAtPosition(){return log("Refreshing stick position."),n.stickAt=n.stickNode.length?n.stickNode.offset().top:0,n.stickAt}function getContainer(e){if(n.container&&n.container.length)return n.container;var o=t("#"+r+"Container");if(o.length)return n.container=o,n.container;if(!0===e)return!1;log("Generating new wallpaper container."),refreshCache();var i=t("<div />",{id:r+"Container",class:r+"-container"});return n.injectionNode.prepend(i),n.container=i,raiseContentArea(),n.container}function raiseContentArea(){var t=getContainer(),e={content:n.contentNode.css(["position","zIndex"]),footer:n.footerNode.css(["position","zIndex"])};log("Checking positioning.",e),e.content&&("relative"!==e.content.position&&"static"!==e.content.position||(log("Setting content area position to relative."),n.contentNode.css("position","relative")),("auto"===e.content.zIndex||e.content.zIndex<=t.css("zIndex"))&&(log("Raising content area above wallpaper container."),n.contentNode.css("zIndex",t.css("zIndex")+1))),e.footer&&"static"===e.footer.position&&(log("Setting footer area position to relative."),n.footerNode.css("position","relative"),n.footerNode.css("zIndex",t.css("zIndex")+2)),n.contentNode.data("originalStyles",e.content),n.footerNode.data("originalStyles",e.footer),log("Content area has been raised.")}function show(){var t;log("Displaying wallpaper."),getContainer().off(s).addClass(r+"-open"),n.obstructiveNode.hide(),startTrackingScroll()}function _reset(){function finishRemoval(){a=!0,n.obstructiveNode.show(),log("Clearing all event listeners."),n.window.off("."+r),o&&o.length&&(log("Removing wallpaper container."),o.off("."+r).remove()),n.container=null,e.resolve()}var e=t.Deferred(),o=getContainer(!0),i=!(!o||!o.length)&&o.hasClass(r+"-open"),a=!1;return log("RESET!"),o&&o.length?(o.off(s).removeData().removeProp("data").css("backgroundColor","rgba(0,0,0,0)").removeClass(r+"-open").removeClass(r+"-fixed"),log("Container is closing."),s&&i&&o.on(s,(function(t){"opacity"===t.originalEvent.propertyName&&(log("Transition complete."),finishRemoval())})),setTimeout((function(){a||finishRemoval()}),800)):finishRemoval(),log("Returning our promise."),e.promise()}function isFixed(){var t;return getContainer().hasClass(r+"-fixed")}function toggleFixed(t){var e=getContainer();isFixed()&&!1===t&&(log("Unfixing wallpaper position."),e.removeClass(r+"-fixed").css("top","0")),isFixed()||!0!==t||(log("Fixing wallpaper position."),refreshStickAtPosition(),e.addClass(r+"-fixed").css("top",n.stickAt))}function startTrackingScroll(){function hasPassedStickPosition(){var t=n.window.scrollTop(),e;return(n.injectionNode.length?n.injectionNode.offset().top:0)<t+n.stickAt}log("Initializing scroll tracking."),refreshStickAtPosition(),hasPassedStickPosition()?toggleFixed(!0):toggleFixed(!1),n.window.on("scroll."+r,a((function(){hasPassedStickPosition()?toggleFixed(!0):toggleFixed(!1)}),50)),n.window.on("resize."+r,l((function(){refreshStickAtPosition()}),500)),log("Scroll tracking enabled.")}function _process(){try{if(t(o.contentNode).height()<200)return void 0===i&&(i=20),0===i?(log("Timed out waiting for content node."),void(i=void 0)):(log("Content node is not ready, retrying.",--i),void setTimeout((function(){_process()}),500));refreshCache(),log("Processing wallpaper slot.");var a,l=n.dfpSlot.find("iframe").contents().find("#google_image_div,body").first(),s=l.find("a:first"),d=l.find("img.img_ad:first,img:first").first(),c=d.prop("alt");if(log("Checking image."),!d.length)return log("No image found in ad slot! Resetting."),void _reset();var g=getContainer(),p=checksum((s.length?s.prop("href")+s.prop("target"):"")+d.prop("src"));if(log("Generated hash.",p),p===g.data("hash"))return void log("Requested wallpaper is already set.");log("Getting background color.",c);var u="rgba(255,255,255,0)",f=c.match(/(\#[A-Za-z0-9]+)/)||!1;f&&f.length>1&&(u=f[1]),log("Using background color.",u),_reset().then((function(){log("Building the new wallpaper.");var o="";s.length&&(o=t("<a />",{href:s.prop("href"),target:s.prop("target")}),e._CMLS.navThroughPlayer&&e._CMLS.navThroughPlayer.updateLink(o[0]));var n=t("<iframe />",{name:r+"Iframe",scrolling:"no",marginWidth:"0",marginHeight:"0",frameborder:"0"});log("Injecting iframe into container."),(g=getContainer()).data("hash",p).css("backgroundColor",u).append(n);var i='<style>html,body{background:transparent;margin:0;padding:0;width:100%;height:100%;}body{background:url("'+d.prop("src")+'") no-repeat top center;}'+(d.prop("alt").indexOf("contain")>-1?"body{background-size:100%}":"")+"a{display:block;width:100%;height:100%;text-decoration:none;}</style>";n.load((function(){log("Injecting wallpaper into iframe."),n.contents().find("body").append(i,o)})).prop("src","about:blank"),d.length?(log("Initializing preloader."),t("<img />").bind("load",(function(){show(),t(this).remove()})).prop("src",d.prop("src"))):show()}))}catch(t){log("WTF PEOPLE",t)}}function checkRenderEvent(t){var e;if(t.slot.getTargeting("pos").indexOf("wallpaper-ad")>-1)return log("Caught render event for wallpaper-ad",t.slot.getSlotElementId()),t.isEmpty?(log("Slot was empty, resetting wallpaper container."),_reset()):(log("Slot contained an ad, processing wallpaper."),_process()),!1}function _unbindAllListeners(){t(e).off("."+r)}var n={},i,r=o.nameSpace||"wallpaperInjector",a=e._CMLS.throttle,l=e._CMLS.debounce,s=determineTransitionEvent();this.reset=_reset,this.process=_process,this.unbindAllListeners=_unbindAllListeners,log("Initializing."),e.googletag=e.googletag||{},e.googletag.cmd=e.googletag.cmd||[],e.googletag.cmd.push((function(){e.googletag.pubads().addEventListener("slotRenderEnded",(function(t){l(checkRenderEvent(t),1e3)}))}));var d='<style id="'+r+'Styles">.'+r+"-container {display: block !important;position: absolute;z-index: 0;top: 0;left: 50%;height: 0 !important;width: 100vw !important;overflow: hidden;text-align: center;transition: opacity 0.5s, height 0.6s, background-color 0.4s;opacity: 0;transform: translateX(-50%);}."+r+"-container iframe {border: 0;height: 100%;width: 100%;}."+r+"-container ~ .grid-container {transition: box-shadow 0.6s}."+r+"-open {height: 100% !important;opacity: 1;}."+r+"-open ~ .grid-container {box-shadow: 0 0 20px rgba(0,0,0,0.3);}."+r+"-fixed {position: fixed;}"+o.dfpSlotNode+" {display: none !important;}</style>";e.document.getElementById(r+"Styles")||t("head").append(d),"complete"===e.document.readyState||"loaded"===e.document.readyState?_process():t((function(){_process()}))}var n={dfpSlotNode:"#div-gpt-ad-1418849849333-16",injectionNode:".wrapper-content",stickNode:".wrapper-header",contentNode:".wrapper-content .grid-container:first",footerNode:".wrapper-footer",obstructiveNode:".takeover-left, .takeover-right, .skyscraper-left, .skyscraper-right"},i="WALLPAPER INJECTOR",r="wallpaperInjector",a="0.5";e._CMLS[r],n.nameSpace=r,e._CMLS[r]=new WallpaperInjector(n)}(jQuery,window),function(t,e,o){function log(){a.logger(n+" v0.1",arguments)}function init(){var o=e._CMLS.adTag,n=a.whichPlayer();if(!n.type)return log("Player not found, checking again in 2 seconds... ("+(5-l)+" checks remaining)"),void(l<5?(l++,setTimeout(init,2e3)):log("Player was not found, exiting for good."));log("Player found",n),o.queue((function(){t((function(){if(t("#CMLSPlayerSponsorship").length)log("Container already exists, exiting.");else{log("Discovering local site ad path.");var e=null;try{var i,r=o.rawInterface().pubads().getSlots();for(var l in r){var s=r[l].getSlotId().getName();if(s&&s.indexOf("/6717/")>-1){e=s;break}}
if(null===e)throw{message:"Could not retrieve ad unit path."}}catch(t){return void log("Failed to retrieve DFP properties.",t)}log("Ad path found, defining new slot.",e),o.defineSlot([e,[[120,60]],"CMLSPlayerSponsorship"],!0,{pos:"playersponsorlogo"},!0),t("body").append('<style id="CMLSPlayerSponsorshipStyle">#CMLSPlayerSponsorship {position: fixed;z-index: 2147483647;width: 120px;height: 60px;}#CMLSPlayerSponsorship.cmls-player-tg {left: 50%;transform: translate(+300px, 0);}#CMLSPlayerSponsorship.cmls-player-triton {left: 50%;transform: translate(30px, 0);}#CMLSPlayerSponsorship.cmls-player-pos-bottom {bottom: 4px;}#CMLSPlayerSponsorship.cmls-player-pos-top {top: 4px;}#CMLSPlayerSponsorship.cmls-player-triton.cmls-player-pos-top {top: 5px;}@media (max-width: 75rem) {#CMLSPlayerSponsorship.cmls-player-tg {left: 50%;}}@media (max-width: 1042px) {#CMLSPlayerSponsorship.cmls-player-tg {display: none}}@media (max-width: 800px) {#CMLSPlayerSponsorship.cmls-player-triton {display: none}}</style>');var d=t('<div id="CMLSPlayerSponsorship"><script>googletag.cmd.push(function() { googletag.display("CMLSPlayerSponsorship")});<\/script></div>'),c="bottom";n.position===a.const.PLAYER_POSITION_TOP&&(c="top"),n.type===a.const.PLAYER_TRITON&&d.addClass("cmls-player-triton"),n.type===a.const.PLAYER_TUNEGENIE&&d.addClass("cmls-player-tg"),"top"===c?d.addClass("cmls-player-pos-top"):d.addClass("cmls-player-pos-bottom"),t("body").append(d),log("Slot initialized.")}}))}))}var n="PLAYER SPONSOR INJECTOR",i="playerSponsorInjector",r="0.1",a=e._CMLS;if(e.self===e.top){var l=0,SponsorArray=function(){};SponsorArray.prototype=[],SponsorArray.prototype.push=function(){init()},e.self._CMLSPlayerSponsorshipInit=new SponsorArray,t(init()),a[i]="0.1"}else t((function(){e.parent._CMLSPlayerSponsorshipInit=e.parent._CMLSPlayerSponsorshipInit||[],e.parent._CMLSPlayerSponsorshipInit.push(1)}))}(window.top.jQuery,window),function(t,e,o){function log(){e.top._CMLS&&e.top._CMLS.logger&&e.top._CMLS.logger(n+" v0.2",arguments)}var n="ZERGNET INJECTOR",i="0.2";if(e.top.NO_ZERGNET||e.parent.NO_ZERGNET||e.NO_ZERGNET)return log("Opted out with window.NO_ZERGNET, ejecting."),!1;var r=e.document;if(r.body.className.indexOf(" single ")<0||r.body.className.indexOf("layout-using-template-1")>-1)return log("Not a single post layout"),!1;var a=r.querySelector(".wrapper-content > .grid-container > .row-1 > .column-1 > .block-type-content > .block-content > .loop > article.post.format-standard,.wrapper-content > .grid-container > .row-1 > .column-1 > .block-type-content > .block-content > .loop > article.feed_post,.wrapper-content > .grid-container > .row-1 > .column-1 > .block-type-content > .block-content > .loop > article.feed_posts");if(!a)return log("Could not discover main page article."),!1;if(a.getBoundingClientRect().width>800)return log("Found main page article, but it's suspiciously wide so we think it is not a normal post."),!1;var l=r.querySelector(".wrapper-content > .grid-container > .row-1 > .column-1");if(!l)return log("Could not determine column."),!1;log("Injecting Zergnet");var s=r.createElement("div");s.id="zergnet-widget-61785",l.appendChild(s);var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.src=("https:"===document.location.protocol.toLowerCase()?"https:":"http:")+"//www.zergnet.com/zerg.js?id=61785";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(d,c)}(jQuery,window.self),function(t,e,o){function log(){e._CMLS.logger(n+" v0.3",arguments)}function fireEvent(t){try{log("Event fired: "+t),sharedContainerDataLayer.push({event:t}),corpDataLayer.push({event:t})}catch(t){}}var n="GTM STREAM TRACKING",i="GTMStreamTracker",r="0.3";e.top.tgmp&&!e._CMLS[i]&&(e._CMLS[i]=!0,e.top.tgmp.addEventListener(e.top.TGMP_EVENTS.streamplaying,(function(t){!0===t?(log("Stream started."),fireEvent("siteplayer-stream-playing")):!1===t&&(log("Stream stopped."),fireEvent("siteplayer-stream-stopped"))})),e.addEventListener("td-player.playing",(function(){fireEvent("siteplayer-stream-playing")})),e.addEventListener("td-player.stopped",(function(){fireEvent("siteplayer-stream-stopped")})),log("Initialized."))}(jQuery,window),function(t,e){function log(){window._CMLS.logger(o+" v0.1",arguments)}function fireEvent(t,e,o){try{log("Event fired: "+t,e,o),sharedContainerDataLayer.push({event:t,"page-visible":e,"page-visible-time-change":o}),corpDataLayer.push({event:t,"page-visible":e,"page-visible-time-change":o})}catch(t){}}function handleVisibilityChange(e){var o=Math.round((t._CMLS.now()-l)/1e3);e||(e=t.document[r]?"hidden":"visible"),window._CMLS.tabVisible=e,fireEvent("page-visibility",e,o),l=t._CMLS.now()}var o="GTM TAB VISIBILITY TRACKING",n="GTMTabVisibilityTracker",i="0.1",r,a;window._CMLS[n]={},void 0!==t.document.hidden?(r="hidden",a="visibilitychange"):void 0!==t.document.mozHidden?(r="mozHidden",a="mozvisibilitychange"):void 0!==t.document.msHidden?(r="msHidden",a="msvisibilitychange"):void 0!==t.document.webkitHidden?(r="webkitHidden",a="webkitvisibilitychange"):void 0!==t.document.oHidden&&(r="oHidden",a="ovisibilitychange");var l=t._CMLS.now();t.document.addEventListener(a,(function(){handleVisibilityChange()}),!1)}(window.self),function(t,e){function log(){t._CMLS&&t._CMLS.logger&&t._CMLS.logger(o+" v0.12",arguments)}function AutoReloader(){function checkCondition(){var e=t.top.document.querySelector('iframe#page_frame,iframe[name="pwm_pageFrame"]');return r.type===t._CMLS.const.PLAYER_TUNEGENIE&&e&&e.contentWindow?e.contentWindow.document.querySelector(o.condition):t.document.querySelector(o.condition)}function getDateWithOffset(t){return new Date(Date.now()+t)}var e={condition:"body.home",timeout:8},o=e,n,i,r=t._CMLS.whichPlayer(),a=this;this.start=function(r){log("Starting timer.",r),a.stop(),o={condition:r.condition||e.condition,timeout:r.timeout||e.timeout},checkCondition()?(log("Starting countdown, reloading at "+(i=getDateWithOffset(6e4*o.timeout))),t._CMLS.autoReload&&(t._CMLS.autoReload.active=!0),n=setInterval(a.tick,1e4)):log("Condition check failed at start.")},this.stop=function(){n&&(log("Stopping timer."),clearInterval(n),n=null,t._CMLS.autoReload&&(t._CMLS.autoReload.active=!1))},this.tick=function(){Date.now()>i.getTime()&&a.fire()},this.fire=function(){if(a.stop(),checkCondition()){var e=t.location.protocol,o=t.location.hostname,n=t.location.href.replace(e+"//"+o,"");if(n.length<1&&(n="/"),r.type===t._CMLS.const.PLAYER_TRITON&&t.History&&t.History.Adapter)return log("Reloading through Triton Player."),void t.History.Adapter.trigger(t,"statechange");if(r.type===t._CMLS.const.PLAYER_TUNEGENIE){var i=t.top.document.querySelector('iframe#page_frame,iframe[name="pwm_pageFrame"]');return i&&i.contentWindow?(log("Reloading through TuneGenie Player frame."),void i.contentWindow.tgmp.updateLocation(n)):(log("Reloading through TuneGenie Player."),void t.tgmp.updateLocation(n))}log("Reloading page."),t.location.reload()}else log("Condition check failed before firing, timer stopped.")},this.push=function(t){log("Received request.",t),a.start(t)}}var o="AUTO-RELOAD PAGE",n="0.12",i;t._CMLS&&(t._CMLS.autoReload&&t._CMLS.autoReload.constructor===Array&&t._CMLS.autoReload.length&&(log("Loaded with request.",t._CMLS.autoReload),i=t._CMLS.autoReload[t._CMLS.autoReload.length-1]),t._CMLS.autoReload&&t._CMLS.autoReload.constructor!==Array||(t._CMLS.autoReload=new AutoReloader)),log("Initialized."),i&&t._CMLS.autoReload.push(i)}(window.top),function(t,e,o){t((function(){e.NO_ADDTHIS_HERE&&t(".addthis-smartlayers").hide()})),e.self!==e.top?e.top.destroyAddThis&&e.top.destroyAddThis():e.top.destroyAddThis=function(){t(e.top.document.querySelectorAll(".addthis-smartlayers")).hide()}}(jQuery,window),function(t,e,o){function log(){e.top._CMLS&&e.top._CMLS.logger&&e.top._CMLS.logger(n+" v"+r,arguments)}var n="ADDTHIS INJECTOR",i="addThisInjector",r="0.6.17",a="ra-55dc79597bae383e";if(e.self.addthis&&e.self.addthis_config&&e.self.addthis_config.pubid&&e.self.addthis_config.pubid!==a)log("AddThis already loaded by local page.");else if(e.self!==e.top?(log("Not top window."),e.top.addthisDestroyer&&e.top.addthisDestroyer(),t(e).unload((function(){log("Removing AddThis layers."),t(".addthis-smartlayers").remove()}))):(log("Loaded in top window."),e.top.addthisDestroyer=function(){if(log("Removing addthis from top window."),t('script[src*="addthis"]').remove(),e.top.addthisLayerReference){log("Instructing addthis to destroy itself.");try{e.top.addthisLayerReference.destroy()}catch(t){}delete e.top.addthisLayerReference,t(".addthis-smartlayers").remove()}else log("No addthis object in top window.")}),e.self.NO_ADDTHIS_HERE)log("NO_ADDTHIS_HERE found, will not build.");else if(e.top._CMLS&&e.top._CMLS.hasOwnProperty("isHomepage")&&e.top._CMLS.isHomepage(e.self))log("Will not build on homepage, exiting.");else{e.self.addthis_config=e.self.addthis_config||{},e.self.addthis_config.pubid=a,log("Building addthis script.");var l=e.self.document.createElement("script");l.onload=function(){},l.src="//s7.addthis.com/js/300/addthis_widget.js#async=1",l.id=i+"-script",l.async=!0,e.self.document.head.appendChild(l),log("Injected.")}}(jQuery,window),function(t,e,o){function log(){a.logger(n+" v0.7",arguments)}var n="BREAKING NEWS BAR",i="BreakingNews",r="0.7",a=e._CMLS||{};Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),a[i]=function(o,n){log("Called",typeof o,o,n);var r={classPrefix:"cmlsBreakingNews",additionalClass:"",position:"above",link:"",target:"_top",beforeText:"Breaking News:",text:"",background:"#900",hoverBackground:"#600",color:"#fff"},l,s=".wrapper-header";if(t(s).length){if("object"!=typeof o||Array.isArray(o))if("object"==typeof o&&Array.isArray(o)&&o.length)(l=r).text=o[0],o.length>1&&(n=o[1]),log("Basic mode!");else{if("object"==typeof o)return void log("Invalid usage!",o,n);(l=r).text=o,log("Basic mode!")}else l=t.extend({},r,o),log("Advanced mode!");!l.link&&n&&(l.link=n),log("Settings:",l);var d="."+l.classPrefix+"-container { display: block; box-sizing: border-box; position: relative; float: none; overflow: hidden; z-index: 10; padding: 1em; color: #fff; background: #900; box-shadow: 0 0 10px rgba(0,0,0,0.4); font-size: 14px; line-height: 1.2; text-decoration: none; outline: 0 }."+l.classPrefix+"-container > a { display: block; color: inherit !important; cursor: pointer; padding: 1em; margin: -1em; }."+l.classPrefix+"-container > a:hover ."+l.classPrefix+"-before { text-decoration: underline; }."+l.classPrefix+"-inner { box-sizing: border-box; max-width: 1020px; margin: 0 auto; }."+l.classPrefix+"-inner_link:hover { background-color: "+l.hoverBackground+"; }."+l.classPrefix+"-before { float: left; font-weight: bold; margin-right: .5em; }."+l.classPrefix+"-text { overflow: hidden; }."+l.classPrefix+"-inner a { text-decoration: underline !important; color: inherit; }@media (max-width: 500px) {."+l.classPrefix+"-before { float: none; margin-bottom: .25em; }}",c='<div class="'+l.classPrefix+'-container"><div class="'+l.classPrefix+'-inner">{{BEFORE}}<div class="'+l.classPrefix+'-text">{{TEXT}}</div></div></div>';if(l.beforeText&&l.beforeText.length){var g='<div class="'+l.classPrefix+'-before">'+l.beforeText+"</div>";c=c.replace("{{BEFORE}}",g)}else c=c.replace("{{BEFORE}}","");if(c=t(c.replace("{{TEXT}}",l.text)),l.link&&l.link.length){var p=t("<a></a>").prop({href:l.link,target:l.target,className:l.classPrefix+"-inner_link"});c.wrapInner(p)}c.css({background:l.background,color:l.color}),c.addClass(l.additionalClass).prop("id","CMLS"+i+"-"+Math.floor(1e7*Math.random())),t("#cmlsBreakingNewsStyles").length||t("head").append('<style id="cmlsBreakingNewsStyles">/* CMLS Breaking News Bar styles */\n'+d+"</style>"),"below"===l.position?(t(s).after(c),t("#cmlsBreakingNewsStyles").append(".takeover-left,.takeover-right,.skyscraper-left,.skyscraper-right { transform: translateY("+c.outerHeight()+"px); }")):t(s).before(c),a.navThroughPlayer&&(log("Applying navThroughPlayer to bar links."),c.find('a:not([href]),a[target="_self"],a[target="_top"],a[target="_parent"]').each((function(){log("Applying navThroughPlayer to a link.",this.href),a.navThroughPlayer.updateLink(t(this))}))),"above"===l.position&&(e.DO_NOT_AUTO_SCROLL=!0)}};var BNInjector=function(){};BNInjector.prototype=[],BNInjector.prototype.push=function(){log("Received after-load request.",arguments),a[i].apply(null,arguments)},e["_CMLS"+i]&&e["_CMLS"+i].length&&e["_CMLS"+i].forEach(a[i]),e["_CMLS"+i]=new BNInjector}(jQuery,window.self),function(t,e,o){function log(){e._CMLS.logger(n+" v0.5",arguments)}var n="SOCIAL LISTEN LIVE LINK",i="socialListenLiveLink",r="0.5";e._CMLS=e._CMLS||{},log("Starting..."),t((function(){function playStream(t){t.preventDefault(),log("Playing stream..."),e.top.tgmp_default_brand&&e.top.tgmp.options.brand!==e.top.tgmp_default_brand?e.top.tgmp.update({brand:e.top.tgmp_default_brand,theme:e.top.tgmp_default_theme,autostart:!0}):e.tgmp.playStream()}if(e.top.tgmp){log("Storing TGMP default configuration."),e.top.tgmp_default_brand=e.top.tgmp_default_brand||""+e.top.tgmp.options.brand,e.top.tgmp_default_theme=e.top_tgmp_default_theme||e.top.tgmp.options.theme;var o='.block-type-social a:has(img[title="Listen Live!!"]),.nav-listenlive a,.nav-listenlive img,.cmlistenlive-start';t("body").off("click",o,playStream).on("click",o,playStream),log("Social Listen Live button activated.")}else log("TuneGenie player not enabled.")})),e._CMLS[i]="0.5",log("Initialized.")}(jQuery,window.self),function(t,e,o){function log(){e._CMLS&&e._CMLS.logger&&e._CMLS.logger(n+" v0.16",arguments)}function parseCommand(t,e,o){var n={brand:t,autostart:!1};return o&&/\d+/.test(o)&&(n.theme=["#"+o]),e&&(n.autostart=!0),n}e._CMLS=e._CMLS||{};var n="SWITCHSTREAM LINKS",i="0.16";e._CMLS.switchTGMPStream=function(t,o,n){var i=e.tgmp||e.top.tgmp||null,r=parseCommand(t,o,n);i&&(log("Switching stream",r),i.update(r))},log("Initializing switchstream links on page."),t((function(){var o;t('.tgmp-switchstream,img[alt*="tgmp-switchstream"],a[alt*="tgmp-switchstream"],a[href*="tgmp-switchstream"]').each((function(){function getVars(t){return log("Requested vars",t),{brand:t.indexOf("tgmp-streamid")>-1?t.match(/tgmp\-streamid\-(\w+)/i)[1]:null,theme:t.indexOf("tgmp-theme")>-1?["#"+t.match(/tgmp\-theme\-(\d+)/i)[1]]:null,autostart:t.indexOf("tgmp-autostart")>-1}}var e=t(this),o=e.prop("alt"),n=e.prop("href"),i={brand:null,theme:null,autostart:!1};if(e.hasClass("tgmp-switchstream")){var r=e.prop("class");log("Using element classes",r),i=getVars(r)}if(o&&o.indexOf("tgmp-switchstream")>-1&&(log("Using element alt attribute",o),i=getVars(o)),n&&n.indexOf("tgmp-switchstream")>-1&&(log("Using element href",n),i=getVars(n)),!i.brand||i.brand.length<2)return log("No brand provided, exiting."),!1;e.data("tgmp-switchstream",i)})).on("click.cmls-tg-switchstream",(function(o){o.preventDefault();var n,i=t(this).data("tgmp-switchstream"),r=e.tgmp||e.top.tgmp||null;i?r?(log("Switching stream",i),r.update(i)):log("TGMP not available!"):log("Link was not initialized, exiting")}))}))}(jQuery,window.self),function(t){function log(){t.top._CMLS&&t.top._CMLS.hasOwnProperty("logger")&&t.top._CMLS.logger(e+" v0.6",arguments)}function GlobalizeSGroups(){var e=0,o=0,n=this;this.fireEvents=function(e){t.sharedContainerDataLayer.push({event:e}),t.corpDataLayer.push({event:e}),t._CMLS.triggerEvent(t,"cms-sgroup",e)},this.globalize=function(){if(!t._CMLS.adTag.pubads()||!t._CMLS.adTag.pubads().getTargeting("cms-sgroup"))return e>10?(log("TERMINATING. Could not retrieve page targeting in a reasonable time."),!1):(log("DFP is not ready, waiting to retry...","Cycles: "+e),clearTimeout(o),o=null,o=setTimeout(n.globalize,500),void e++);t._CMLS.cGroups=t._CMLS.adTag.pubads().getTargeting("cms-sgroup")||[],t.sharedContainerDataLayer=t.sharedContainerDataLayer||[],t.corpDataLayer=t.corpDataLayer||[];var i=!1;t._CMLS.cGroups.forEach((function(t){log("Firing cms-sgroup event",t),n.fireEvents(t),t.indexOf("Westwood One")>-1&&(i=!0)})),!0===i?n.fireEvents("Westwood One Property"):n.fireEvents("Cumulus Owned and Operated")},n.globalize()}var e="GLOBALIZE SGROUPS",o="globalizeSGroups",n="0.6";t._CMLS[o]?log("Already registered."):t._CMLS.adTag.queue((function(){log("adTag command queue initiated."),t._CMLS[o]=new GlobalizeSGroups}))}(window.self);
//# sourceMappingURL=compiled-allsites-min.js.map