!function(e,t){function r(){e._CMLS&&e._CMLS.debug&&"object"==typeof console&&console.log&&console.log("[SMART APP BANNER INJECTOR "+a+"]",[].slice.call(arguments))}function n(){return e._CMLS.smartBanner?(r("Injecting",o),void e._CMLS.smartBanner({icon:{color:o.backgroundColor},title:o.title,author:o.author,button:"View"})):void setTimeout(n,300)}var a="0.11",o={title:e.document.title,author:"Cumulus",backgroundColor:"transparent",appWidgetSelector:".free-apps,.mobile-apps",headerSelector:".wrapper-header",logoSelector:"figure.logo img",styleSheetUrl:"https://cdn.rawgit.com/cumulus-digital/amp-cms-utils/3f5b5d858347dd35e7a8ecb47ccbbca614e012c0/advertising/smartbanner/smartbanner.css",libraryUrl:"https://cdn.rawgit.com/cumulus-digital/amp-cms-utils/3f5b5d858347dd35e7a8ecb47ccbbca614e012c0/advertising/smartbanner/smartbanner.js"};if(e._CMLS=e._CMLS||{},e._CMLS.smartBannerEnabled)return void r("Already enabled, skipping.");var i={getAppIds:function(e){var t={},n={apple:e.querySelector('a[href*="itunes.apple.com/us/app"]'),google:e.querySelector('a[href*="play.google.com/store/apps"]')};if(n.apple){var a=n.apple.getAttribute("href").match(/id(\d+)/i);a&&a.length&&(t.apple=a[1])}if(n.google){var o=n.google.getAttribute("href").match(/id=([0-9A-Za-z\.]+)/i);o&&o.length&&(t.google=o[1])}return n.apple||n.google?(r("Discovered app IDs",t),t):null},createMetaTags:function(t){r("Generating meta tags");var n=[],a={apple:"apple-itunes-app",google:"google-play-app"},o;for(var i in t)a[i]&&(o=e.document.createElement("meta"),o.setAttribute("name",a[i]),o.setAttribute("content","app-id="+t[i]),n.push(o));return n.length?(r("Generated meta tags",n),n):null},createNiceTitle:function(e){var t=e.replace(/(\|\s*)?Cumulus(\|\s*)?/,"").match(/\|\s*([^\|]*)(\|.*)?$/);return t&&t.length?(r("Using nice title",t[1]),t[1]):e},createIconLinks:function(t){if(!t)return null;var n=t.getAttribute("src");if(n){r("Generating link tags with logo image url",n);var a=e.document.createElement("link");a.setAttribute("rel","apple-touch-icon"),a.setAttribute("href",n);var o=e.document.createElement("link");return a.setAttribute("rel","android-touch-icon"),a.setAttribute("href",n),[a,o]}return null},getBackgroundColor:function(e){var t=getComputedStyle(e,null).getPropertyValue("background-color");return r("Getting background color",t),t?(r("Got background color",t),t):"transparent"},appendToHead:function(t){r("Injecting support nodes into head.",t);for(var n=e.document.querySelector("head"),a=0;a<t.length;a++)n.appendChild(t[a])},init:function(){var t=e.document.querySelector(o.appWidgetSelector);if(!t)return r("No app widget found, ejecting."),!1;var n=[],a=this.createNiceTitle(e.document.title),i=e.document.querySelector(o.logoSelector),c=this.getBackgroundColor(e.document.querySelector(o.headerSelector)),l=this.createMetaTags(this.getAppIds(t));if(!l||!l.length)return r("No app IDs found, ejecting."),!1;n=n.concat(l);var u=this.createIconLinks(i);n=n.concat(u);var s=e.document.createElement("link");if(s.setAttribute("rel","stylesheet"),s.setAttribute("href",o.styleSheetUrl),n.push(s),!e._CMLS.smartBanner){var d=e.document.createElement("script");d.src=o.libraryUrl,n.push(d)}return this.appendToHead(n),o.title=a,o.backgroundColor=c,!0}},c=function(e){"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e)};c(function(){r("Initializing.");var e=i.init();e&&n()}),r("Loaded.")}(window);
//# sourceMappingURL=./injector-min.js.map