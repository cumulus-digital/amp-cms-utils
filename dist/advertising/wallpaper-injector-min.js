!function($,e,t){function o(){c.log(r+" v"+d,arguments)}function n(t){function n(){return m.dfpSlot=$(t.dfpSlotNode),m.injectionNode=$(t.injectionNode),m.stickNode=$(t.stickNode),m.contentNode=$(t.contentNode),m.footerNode=$(t.footerNode),m.obstructiveNode=$(t.obstructiveNode),m.window=$(e),m.document=$(e.document),d(),m}function i(e){if(m.container&&m.container.length)return m.container;var t=$("#"+a+"Container");return t.length?(m.container=t,m.container):e===!0?!1:(o("Generating a new wallpaper container."),n(),m.container=$("<div />",{id:a+"Container","class":a+"-container"}).prependTo(m.injectionNode),r(),m.container)}function r(){m.contentNode.addClass(a+"-raiser"),m.footerNode.addClass(a+"-raiser")}function d(){return o("Refreshing sticky position."),m.stickAt=m.stickNode.length?m.stickNode.offset().top:0,m.stickAt}function s(){var e=i();return e.hasClass(a+"-fixed")}function l(e){var t=i(),n=s();(n||e===!1)&&(o("Unfixing wallpaper position."),t.css("top","0").removeClass(a+"-fixed")),n&&e!==!0||(o("Fixing wallpaper position"),d(),t.css("top",m.stickAt).addClass(a+"-fixed"))}function p(){function e(){var e=m.window.scrollTop(),t=m.injectionNode.length?m.injectionNode.offset().top:0;return d(),t<e+m.stickAt?!0:!1}o("Initializing scroll tracking."),l(e()?!0:!1),m.window.on("scroll."+a,v(function(){return e()?void l(!0):void l(!1)},50)),m.window.on("resize."+a,w(function(){d()},500)),o("Scroll tracking enabled.")}function g(){o("Displaying wallpaper.");var e=i();e.addClass(a+"-open"),m.obstructiveNode.hide(),p()}function f(){var e=$.Deferred(),t=i();return m.obstructiveNode.show(300),m.window.off("."+a),t.removeData().removeProp("data").css("backgroundColor","rgba(0,0,0,0)").removeClass([a+"-open",a+"-fixed"]),setTimeout(function(){e.resolve()},500),e.promise()}function u(){if($(t.contentNode).height()<200)return o("Content node is not yet ready, retrying..."),void setTimeout(function(){u()},500);n(),o("Processing wallpaper request.");var e=m.dfpSlot.find("iframe"),r=e.contents().find("#google_image_div,body").first(),d=r.find("a:first"),s=r.find("img.img_ad:first,img:first").first(),l=s.prop("alt"),p=i();if(d.prop("href")===p.data("slotlink")&&s.prop("src")===p.data("slotimage"))return void o("Requested wallpaper is already set.");if(o("Checking image."),!s.length)return o("No image found in ad slot, resetting."),void f();var h="rgba(255,255,255,0)",v=l.match(/((\#[A-Za-z0-9]+)|(rgba?\(.*\)))/)||!1;v&&v.length>1&&(h=v[1]),o("Using background color.",h),f().then(function(){o("Building new wallpaper.");var e,t,n,r=i();d.length&&(e=$("<a/>",{href:d.prop("href"),target:d.prop("target")}),c.navThroughPlayer&&c.navThroughPlayer.updateLink(e),r.data("slotlink",d.prop("href"))),t=$("<iframe />",{name:a+"Iframe",scrolling:"no",marginWidth:"0",marginHeight:"0",frameborder:"0",src:"about:blank"}),n='<style>html, body { background: transparent; margin: 0; padding: 0; width: 100%; height: 100%; }body { background: url("'+s.prop("src")+'") no-repeat top center; }a { display: block; width: 100%; height: 100%; text-decoration: none; }</style>',t.load(function(){o("Injecting wallpaper into frame."),t.contents().find("body").append(n,e)}),o("Injecting iframe into container."),r.css("backgroundColor",h).append(t),s.length?$("<img/>").bind("load",function(){g(),$(this).remove()}).prop("src",s.prop("src")):g()})}function h(e){var t=e.slot.getTargeting("pos");return t.indexOf("wallpaper-ad")>-1?(o("Caught render event for wallpaper-ad",e.slot.getSlotElementId()),e.isEmpty?(o("Slot was empty, resetting wallpaper container."),f()):(o("Slot contained an ad, processing wallpaper."),u()),!1):void 0}o("Initializing.");var m={},v=c.throttle,w=c.debounce,N='<style id="%%NAMESPACE%%Styles">.%NAMESPACE%-container {display: block;position: absolute;z-index: 0;top: 0;left: 0;height: 0;width: 100%;overflow: hidden;text-align: center;transition: opacity 0.5s, height 0.6s, background-color 0.4s;opacity: 0;}.%NAMESPACE%-container iframe {border: 0;height: 100%;width: 100%;}.%NAMESPACE%-container ~ .grid-container {transition: box-shadow 0.6s}.%NAMESPACE%-open {height: 100%;opacity: 1;}.%NAMESPACE%-open ~ .grid-container {box-shadow: 0 0 20px rgba(0,0,0,0.3);}.%NAMESPACE%-fixed {position: fixed;}.%NAMESPACE%-raiser {position: relative !important;z-index: 5 !important;}%DFPSLOTNODE% {display: none;}'+"</style>".replace(/%NAMESPACE%/g,a).replace(/%DFPSLOTNODE%/g,t.dfpSlotNode);$(N).appendTo("head"),e.googletag=e.googletag||{},e.googletag.cmd=e.googletag.cmd||[],e.googletag.cmd.push(function(){e.googletag.pubads().addEventListener("slotRendereEnded",function(e){w(h(e),1e3)})}),"complete"===e.self.document.readyState||"loaded"===e.self.document.readyState?u():e.document.addEventListener("DOMContentLoaded",function(){u()})}var i={dfpSlotNode:"#div-gpt-ad-1418849849333-16",injectionNode:".wrapper-content",stickNode:".wrapper-header",contentNode:".wrapper-content .grid-container:first",footerNode:".wrapper-footer",obstructiveNode:".takeover-left, .takeover-right, .skyscraper-left, .skyscraper-right"},r="WALLPAPER INJECTOR",a="wallpaperInjector",d="0.6",c=e._CMLS;c[a]||(i.nameSpace=a,c[a]=new n)}(jQuery,window);
//# sourceMappingURL=./wallpaper-injector-min.js.map