!function(e,i){function log(){e.top._CMLS&&e.top._CMLS.hasOwnProperty("logger")&&e.top._CMLS.logger(t+" v"+o,arguments)}var t="AUTO REFRESH ADS",n="autoRefreshAds",o="0.6.1";if(e.DISABLE_AUTO_REFRESH_ADS)return log("Auto Refresh Ads is disabled"),!1;e._CMLS.autoRefreshAdsTimer=e._CMLS.autoRefreshAdsTimer||1.5;var AutoRefresher=function(i){function getWindow(){if(d.type===e._CMLS.const.PLAYER_TUNEGENIE){var i=e.top.document.querySelector('iframe#page_frame,iframe[name="pwm_pageFrame"]');if(i&&i.contentWindow)return log("Window context is TuneGenie frame"),i.contentWindow}return log("Window context is window"),e}function checkConditions(){return e.top._CMLS.autoReload&&e.top._CMLS.autoReload.active?(log("AutoReloadPage is active, autoRefreshAds will be disabled."),-1):"visible"!==n?(log("Tab is hidden, autoRefreshAds will skip this cycle."),0):1}function checkTimer(){if(1===checkConditions()){var e=new Date;if(log("Checking timer",[e.toLocaleString(),s.toLocaleString()]),e.getTime()>=s.getTime())return void fire()}a=setTimeout(checkTimer,1e4)}function isElVisible(i){if(!i)return!1;var t=!1;i.style&&i.style.display&&"none"===i.style.display&&i.setAttribute("style","display: block; width: 1px; height: 1px;");var n=i.getBoundingClientRect();if(n.width=n.right-n.left,n.height=n.bottom-n.top,0===n.width||0===n.height)return!1;var o=n.top+n.height/2,r=n.right-n.width/2,d=n.bottom-n.height/2,a=n.left+n.width/2;return d>=0&&r>=0&&o<=(e.innerHeight||document.documentElement.clientHeight)&&a<=(e.innerWidth||document.documentElement.clientWidth)}function recordTabVisibility(i){i||(i=e.document[o]?"hidden":"visible"),n=i}function fire(){if(1===checkConditions()){var e=getWindow();return log("Firing!",e._CMLS.adTag),void e._CMLS.adTag.queue((function(){log("Refreshing viewable page ads."),t.resetFireTime();try{var i=e._CMLS.adTag.pubads().getSlots(),n=[];i.forEach((function(i){var t=e.document.getElementById(i.getSlotElementId());t&&isElVisible(t)&&n.push(i)})),log("Viewable ads:",n),e._CMLS.adTag.refresh(n)}catch(e){log("Failed to refresh ads!",e)}t.start()}))}log("Conditions were not met before firing, skipping this cycle."),t.start()}var t=this,n="visible",o,r,d=e._CMLS.whichPlayer(),a=null,s=i||null,l=!1;void 0!==e.document.hidden?(o="hidden",r="visibilitychange"):void 0!==e.document.mozHidden?(o="mozHidden",r="mozvisibilitychange"):void 0!==e.document.msHidden?(o="msHidden",r="msvisibilitychange"):void 0!==e.document.webkitHidden?(o="webkitHidden",r="webkitvisibilitychange"):void 0!==e.document.oHidden&&(o="oHidden",r="ovisibilitychange"),e.document.addEventListener(r,(function(){recordTabVisibility()}),!1),this.checkState=function(){return l},this.stop=function(){log("Stopping timer."),clearTimeout(a),a=null,s=null,l=!1},this.start=function(e){return t.stop(),1===checkConditions()&&(e&&e instanceof Date?(log("Start called with an init fire time.",e),s=e):t.resetFireTime(),log("Starting timer, will fire at "+s.toLocaleString()),checkTimer(),l=!0),t},this.destroy=function(){t.stop()},this.getFireTime=function(){return s},this.resetFireTime=function(){s=new Date((new Date).getTime()+6e4*e._CMLS.autoRefreshAdsTimer)},s&&s instanceof Date&&(log("Instantiated with a time to fire, using it!"),t.start(s))};e._CMLS[n]=new AutoRefresher,e._CMLS[n].start()}(window.self);
//# sourceMappingURL=auto-refresh-ads-constant-min.js.map